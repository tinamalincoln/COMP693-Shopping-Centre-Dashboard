{% extends "layout.html" %}

{% block title %}Shopping Centre Search Result{% endblock %}

{% block content %}


{% if centre %}
<style>
  .full-height-container {
    display: flex;
    height: calc(100vh - 120px);
  }
  .info-panel {
    width: 33.33%;
    padding: 1rem;
    overflow-y: auto;
    background-color: #f8f9fa;
    border-right: 1px solid #ddd;
  }
  #map {
    width: 66.66%;
    height: 100%;
  }
  @media (max-width: 768px) {
    .full-height-container {
      flex-direction: column;
      height: auto;
    }
    .info-panel, #map {
      width: 100%;
      height: 400px;
    }
  }
</style>

<div class="full-height-container">
  <!-- Info panel -->
<div class="info-panel">
  <h4 class="mb-3"><i class="fas fa-store"></i> {{ centre.name }}</h4>

  <div class="card mb-3">
    <div class="card-header bg-primary text-white">
      <i class="fas fa-info-circle"></i> General Information
    </div>
    <ul class="list-group list-group-flush">
      <li class="list-group-item"><i class="fas fa-map-marker-alt me-2"></i><strong>Location:</strong> {{ centre.location }}</li>
      <li class="list-group-item"><i class="fas fa-tags me-2"></i><strong>Classification:</strong> {{ centre.classification }}</li>
      <li class="list-group-item"><i class="fas fa-building me-2"></i><strong>Centre Type:</strong> {{ centre.centre_type }}</li>
      <li class="list-group-item"><i class="fas fa-calendar-alt me-2"></i><strong>Date Opened:</strong> {{ centre.date_opened or 'N/A' }}</li>
    </ul>
  </div>

  <div class="card mb-3">
    <div class="card-header bg-success text-white">
      <i class="fas fa-ruler-combined"></i> Size & Facilities
    </div>
    <ul class="list-group list-group-flush">
      <li class="list-group-item"><i class="fas fa-expand-arrows-alt me-2"></i><strong>Total Retail Space:</strong> {{ centre.total_retail_space or 'N/A' }} mÂ²</li>
      <li class="list-group-item"><i class="fas fa-vector-square me-2"></i><strong>Site Area:</strong> {{ centre.site_area_ha or 'N/A' }} ha</li>
      <li class="list-group-item"><i class="fas fa-layer-group me-2"></i><strong>Levels:</strong> {{ centre.levels or 'N/A' }}</li>
    </ul>
  </div>

  <div class="card mb-3">
    <div class="card-header bg-info text-white">
      <i class="fas fa-parking"></i> Parking & Development
    </div>
    <ul class="list-group list-group-flush">
      <li class="list-group-item"><i class="fas fa-car me-2"></i><strong>Covered Parking:</strong> {{ centre.covered_parking_num or 0 }}</li>
      <li class="list-group-item"><i class="fas fa-car-side me-2"></i><strong>Uncovered Parking:</strong> {{ centre.uncovered_parking_num or 0 }}</li>
      <li class="list-group-item"><i class="fas fa-tools me-2"></i><strong>Redevelopments:</strong> {{ centre.redevelopments or 'N/A' }}</li>
    </ul>
  </div>
</div>




  <!-- Map -->
  <div id="map"></div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var lat = '{{ lat }}';
    var lon = '{{ lon }}';
    var centreName = '{{ centre.name | tojson }}';

    var map = L.map('map').setView([lat, lon], 16);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'
    }).addTo(map);

    L.marker([lat, lon]).addTo(map)
      .bindPopup(centreName)
      .openPopup();
  });
</script>

{% elif error %}
<div class="alert alert-danger mt-3">{{ error }}</div>
{% endif %}

{% endblock %}
