{% extends "layout.html" %}

{% block title %}Shopping Centre Search Result{% endblock %}

{% block content %}


{% if centre %}
<style>
  .full-height-container {
    display: flex;
    height: calc(100vh - 120px);
  }
  .info-panel {
    width: 33.33%;
    padding: 1rem;
    overflow-y: auto;
    background-color: #f8f9fa;
    border-right: 1px solid #ddd;
  }
  #map {
    width: 66.66%;
    height: 100%;
  }
  @media (max-width: 768px) {
    .full-height-container {
      flex-direction: column;
      height: auto;
    }
    .info-panel, #map {
      width: 100%;
      height: 400px;
    }
  }
</style>

<div class="full-height-container">
  <!-- Info panel -->
  <div class="info-panel">
    <h4>{{ centre.name }}</h4>
    <ul class="list-group">
      <li class="list-group-item"><strong>Location:</strong> {{ centre.location }}</li>
      <li class="list-group-item"><strong>Classification:</strong> {{ centre.classification }}</li>
      <li class="list-group-item"><strong>Centre Type:</strong> {{ centre.centre_type }}</li>
      <li class="list-group-item"><strong>Total Retail Space:</strong> {{ centre.total_retail_space or 'N/A' }} mÂ²</li>
      <li class="list-group-item"><strong>Date Opened:</strong> {{ centre.date_opened or 'N/A' }}</li>
    </ul>
  </div>

  <!-- Map -->
  <div id="map"></div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var lat = '{{ lat }}';
    var lon = '{{ lon }}';
    var centreName = '{{ centre.name | tojson }}';

    var map = L.map('map').setView([lat, lon], 16);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'
    }).addTo(map);

    L.marker([lat, lon]).addTo(map)
      .bindPopup(centreName)
      .openPopup();
  });
</script>

{% elif error %}
<div class="alert alert-danger mt-3">{{ error }}</div>
{% endif %}

{% endblock %}
